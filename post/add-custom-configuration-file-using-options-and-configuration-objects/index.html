<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Add custom configuration file using options and configuration objects | Gridea</title>
<meta name="description" content="温故而知新">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://jinjupeng.github.io/favicon.ico?v=1638600785168">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://jinjupeng.github.io/styles/main.css">


<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://jinjupeng.github.io">Gridea</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                首页
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                归档
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                标签
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                关于
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>Add custom configuration file using options and configuration objects</h1>
            <p class="article-meta">
              2021-12-04
              
                <a href="https://jinjupeng.github.io/tag/T4kXEiyWA/" class="badge secondary">
                  netcore
                </a>
              
            </p>
            
            <div class="post-content">
              <p>It can be usefull to have multiple configuration files, and it follows some develoment best practices like the Interface Segregation Principle or the Separation of Concerns. Moreover, it allows you to have the behavior you want on each configuration file.</p>
<p>It's very simple and asy to do this using options and configuration objects.</p>
<p>The first step is to add a file in your project, here customSettings.json, with the content :</p>
<pre><code>{
    &quot;CustomSection1&quot;: {
        &quot;Hi&quot;: &quot;Hi!&quot;,
        &quot;Hello&quot;: &quot;Hello!&quot;
    },
    &quot;CustomSection2&quot;: {
        &quot;Bye&quot;: &quot;Bye!&quot;
     }
}
</code></pre>
<p>Create the model of the configuration settings you want to add :</p>
<pre><code>namespace WebApplication1.Models.CustomSettings
{
    public class CustomSection1
    {
        public string Hi { get; set; }
        public string Hello { get; set; }
    }

    public class CustomSection2
    {
        public string Bye { get; set; }
    }
}
</code></pre>
<p>Then, use the configuration provider you want (the JSON one here), and add your class to the service container and bound to configuration :</p>
<pre><code>public class Startup
{
    public Startup(IHostingEnvironment env)
    {
        var builder = new ConfigurationBuilder()
            .SetBasePath(env.ContentRootPath)
            .AddJsonFile(&quot;appsettings.json&quot;, optional: true, reloadOnChange: true)
            .AddJsonFile($&quot;appsettings.{env.EnvironmentName}.json&quot;, optional: true)
            .AddJsonFile($&quot;customSettings.json&quot;, optional: true, reloadOnChange: true)
            .AddEnvironmentVariables();

        if (env.IsDevelopment())
        {
            // This will push telemetry data through Application Insights pipeline faster, allowing you to view results immediately.
            builder.AddApplicationInsightsSettings(developerMode: true);
        }
        Configuration = builder.Build();
    }

    public IConfigurationRoot Configuration { get; }

    // This method gets called by the runtime. Use this method to add services to the container.
    public void ConfigureServices(IServiceCollection services)
    {
        // Add framework services.
        services.AddApplicationInsightsTelemetry(Configuration);

        services.Configure&lt;CustomSection1&gt;(options =&gt; Configuration.GetSection(&quot;CustomSection1&quot;).Bind(options));
        services.Configure&lt;CustomSection2&gt;(options =&gt; Configuration.GetSection(&quot;CustomSection2&quot;).Bind(options));

        services.AddMvc();
    }
</code></pre>
<p>Work is done ! You can now access your settings from your controllers using Dependency Injection on IOptions :</p>
<pre><code>public class HomeController : Controller
{
    private readonly CustomSection1 _customSection1;

    private readonly CustomSection2 _customSection2;

    public HomeController(
        IOptions&lt;CustomSection1&gt; customSection1
        , IOptions&lt;CustomSection2&gt; customSection2)
    {
        _customSection1 = customSection1.Value;
        _customSection2 = customSection2.Value;
    }
}</code></pre>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
            <div class="next-post">
              <div class="next">
                下一篇
              </div>
              <a href="https://jinjupeng.github.io/post/hello-gridea/">
                <h3 class="post-title">
                  Hello Gridea
                </h3>
              </a>
            </div>
          
        </div>
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://jinjupeng.github.io/images/avatar.png?v=1638600785168" class="no-responsive avatar">
    <div class="text-muted">温故而知新</div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      最新文章
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://jinjupeng.github.io/post/add-custom-configuration-file-using-options-and-configuration-objects/">Add custom configuration file using options and configuration objects</a>
            </li>
          
        
          
            <li>
              <a href="https://jinjupeng.github.io/post/about/">关于</a>
            </li>
          
        
          
            <li>
              <a href="https://jinjupeng.github.io/post/hello-gridea/">Hello Gridea</a>
            </li>
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      标签列表
    </div>
    <div class="row">
      
        <a href="https://jinjupeng.github.io/tag/T4kXEiyWA/" class="badge success">
          netcore
        </a>
      
        <a href="https://jinjupeng.github.io/tag/LOZgx7_CN/" class="badge success">
          Gridea
        </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://jinjupeng.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>




  </body>
</html>
